package com.napier.g7cw.obj;

import com.napier.g7cw.db.*;


/**
 * A class to generate reports given various types of information
 * <p>Contains a lastGenerated variable, used for various functions which print Reports</p>
 * <p><b>Usage:</b></p>
 * <p>Create a new Report object, attach a DB object, .generate() a report (returns a string), the return value of .generate() can be printed using .display()</p>
 */
public class Report {
    DB db;
    private String lastGenerated;

    /**
     * Constructor
     * @param db
     * A DB object to "attach" to the Report class to allow access to additional data as-needed
     */
    public Report(DB db) {
        this.db = db;
        lastGenerated = "";
    }


    /**
     * Report generator for cities
     * @param c
     * The provided city to generate a report for
     * @return
     * A string containing the report generated
     */
    public String generate(City c) {
        lastGenerated = "City Report:\n" +
                "\tName: " + c.Name + "\n" +
                // Use countryCode to get country from database
                "\tCountry: " + CountryDBA.getCountry(db, c.CountryCode).LocalName + "\n" +
                "\tDistrict: " + c.District + "\n" +
                "\tPopulation: " + c.Population + "\n";
        return lastGenerated;
    }


    /**
     * Report generator for continents
     * @param c
     * The provided continent to generate a report for
     * @return
     * A string containing the report generated
     */
    public String generate(Continent c) {
        lastGenerated = "Continent: " + c.Name;
        return lastGenerated;
    }


    /**
     * Report generator for country
     * @param c
     * The provided country to generate a report for
     * @return
     * A string containing the report generated
     */
    public String generate(Country c) {
        Report capitalReport = new Report(db);
        Report countryLanguagesReport = new Report(db);
        capitalReport.generate(c.Capital);
        lastGenerated = "Country Report:\n" +
                "\tName: " + c.Name + "\n" +
                "\tContinent: " + c.Continent + "\n" +
                "\tRegion: " + c.Region + "\n" +
                "\tSurface Area: " + c.SurfaceArea + "\n" +
                "\tIndependence Year: " + c.IndepYear + "\n" +
                "\tPopulation: " + c.Population + "\n" +
                "\tLife Expectancy: " + c.LifeExpectancy + "\n" +
                "\tGNP: " + c.GNP + "\n" +
                "\tGNP Old: " + c.GNPOld + "\n" +
                "\tGovernment: " + c.LocalName + "\n" +
                "\tHead of State: " + c.LocalName + "\n" +
                "\tCapital: " + capitalReport.generate(c.Capital) + "\n" +
                "\tLanguages: " + capitalReport.generate(c.Languages) + "\n";
        return lastGenerated;
    }


    /**
     * Report generator for country languages
     * @param cl
     * The provided languages to generate a report for
     * @return
     * A string containing the report generated
     */
    public String generate(CountryLanguages cl) {
        lastGenerated = "Country Languages Report:\n" +
                "\tCountry Code: " + cl.CountryCode + "\n" +
                "\tOfficial Languages:\n";
        for (Language l : cl.Official) {
            lastGenerated += "\t\t" + l.Name + " (" + l.Percentage + "%)\n";
        }
        lastGenerated += "\tOther Languages:\n";
        for (Language l : cl.Other) {
            lastGenerated += "\t\t" + l.Name + " (" + l.Percentage + "%)\n";
        }

        return lastGenerated;
    }


    /**
     * Report generator for a single language
     * @param l
     * The provided languages to generate a report for
     * @return
     * A string containing the report generated
     */
    public String generate(Language l) {
        lastGenerated = "Langauage Report:\n" +
                "\tName: " + l.Name + "\n" +
                "\tCountry Code: " + l.CountryCode + "\n" +
                "\tIs Official: " + l.IsOfficial + "\n" +
                "\tPercentage: " + l.Percentage + "\n";
        return lastGenerated;
    }


    /**
     * Prints the last report generated
     */
    public void display() {
        System.out.println(lastGenerated);
    }

    /**
     * Prints the last report generated by a Report object
     * @param report
     * The {@link com.napier.g7cw.obj.Report} object to print the report of
     */
    public static void display(Report report) {
        report.display();
    }


    /**
     * String representation of a Report is its last generated report
     */
    @Override
    public String toString() {
        return lastGenerated;
    }
}
